/*!
  * vue-router v4.0.0-alpha.0
  * (c) 2019 Eduardo San Martin Morote
  * @license MIT
  */
/*!
  * vue-router v4.0.0-alpha.0
  * (c) 2019 Eduardo San Martin Morote
  * @license MIT
  */
const t={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{}};var e,n;Object.defineProperty(t,"matched",{enumerable:!1}),function(t){t.pop="pop",t.push="push"}(e||(e={})),function(t){t.back="back",t.forward="forward",t.unknown=""}(n||(n={}));const r={fullPath:"",path:"",query:{},hash:""};function o(t){let e="",n={},r="",o="";const i=t.indexOf("?"),a=t.indexOf("#",i>-1?i:0);return i>-1&&(e=t.slice(0,i),r=t.slice(i+1,a>-1?a:t.length),n=u(c(r))),a>-1&&(e=e||t.slice(0,a),o=t.slice(a,t.length)),e=e||t,{fullPath:t,path:e,query:n,hash:o}}function i(t){try{t=decodeURIComponent(t)}catch(e){console.warn(`[vue-router] error decoding query "${t}". Keeping the original value.`)}return t}function a(t){try{t=encodeURIComponent(t)}catch(e){console.warn(`[vue-router] error encoding query "${t}". Keeping the original value.`)}return t}function c(t){const e="?"===t[0],n={};if(""===t||"?"===t)return n;const r=(e?t.slice(1):t).split("&");for(let t=0;t<r.length;++t){let[e,o]=r[t].split("=");if(e=i(e),o=i(o),e in n){let t=n[e];Array.isArray(t)||(t=n[e]=[t]),t.push(o)}else n[e]=o}return n}function s(t){let e=t.path,n=t.query?function(t){let e="";for(const n in t){e.length>1&&(e+="&");const r=t[n];if(null===r){e+=n;continue}let o=a(n),i=Array.isArray(r)?r:[r];i=i.map(a),e+=`${o}=${i[0]}`;for(let t=1;t<i.length;t++)e+=`&${o}=${i[t]}`}return e}(t.query):"";return e+(n&&"?"+n)+(t.hash||"")}function u(t){const e={};for(const n in t){const r=t[n];e[n]=null===r?"":r}return e}function l(t){return"string"==typeof t?o(t):{fullPath:s(t),path:t.path,query:t.query?u(t.query):{},hash:t.hash||""}}function f(t,e){return e&&0===t.indexOf(e)&&t.replace(e,"")||t}function h(t){return t?{x:t.scrollLeft,y:t.scrollTop}:{x:window.pageXOffset,y:window.pageYOffset}}const p=/^#\d/;function d(t){let e=null;if("selector"in t){const n=p.test(t.selector)?document.getElementById(t.selector.slice(1)):document.querySelector(t.selector);if(n){e=function(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:r.left-n.left-e.x,y:r.top-n.top-e.y}}(n,t.offset||{x:0,y:0})}}else e={x:t.x,y:t.y};e&&window.scrollTo(e.x,e.y)}var m,y,g,w,v,b;const $="__RouterError";class E extends Error{constructor(t){super(t),this[m]=!0;const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e}static is(t){return"Error"===t.name?t[$]:t instanceof E}get name(){return this.constructor.name}}m=$;const x="__NoRouteMatchError";class P extends E{constructor(t,e){super("No match for\n"+JSON.stringify(t)+(e?"\nwhile being at\n"+JSON.stringify(e):"")),this[y]=!0}static is(t){return"Error"===t.name?t[x]:t instanceof P}}y=x;const R="__InvalidRouteMatch";class O extends E{constructor(t){super(`Cannot redirect using a relative location:\n${S(t)}\nUse the function redirect and explicitely provide a name`),this[g]=!0}static is(t){return"Error"===t.name?t[R]:t instanceof O}}g=x;const q="__NavigationGuardRedirect";class _ extends E{constructor(t,e){super(`Redirected from "${t.fullPath}" to "${S(e)}" via a navigation guard`),this[w]=!0,this.from=t,this.to=e}static is(t){return"Error"===t.name?t[q]:t instanceof _}}w=x;const k="__NavigationAborted";class A extends E{constructor(t,e){super(`Navigation aborted from "${e.fullPath}" to "${t.fullPath}" via a navigation guard`),this[v]=!0,this.from=e,this.to=t}static is(t){return"Error"===t.name?t[k]:t instanceof A}}v=k;const j="__NavigationCancelled";class L extends E{constructor(t,e){super(`Navigation cancelled from "${e.fullPath}" to "${t.fullPath}" with a new \`push\` or \`replace\``),this[b]=!0,this.from=e,this.to=t}static is(t){return"Error"===t.name?t[j]:t instanceof L}}b=j;const N=["params","query","hash"];function S(t){if("string"==typeof t)return t;if("path"in t)return t.path;const e={};for(const n of N)n in t&&(e[n]=t[n]);return JSON.stringify(e,null,2)}const C="[^/]+?",I={sensitive:!1,strict:!1,start:!0,end:!0,encode:t=>t,decode:t=>t};function U(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=e[n]-t[n];if(r)return r;n++}return t.length<e.length?1===t.length&&80===t[0]?-1:1:t.length>e.length?1===e.length&&80===e[0]?1:-1:0}function T(t,e){let n=0;const r=t.score,o=e.score;for(;n<r.length&&n<o.length;){const t=U(r[n],o[n]);if(t)return t;n++}return o.length-r.length}const z={type:0,value:""},K=/[a-zA-Z0-9_]/;function M(t,e,n){return{...function(t,e){const n={...I,...e};let r=[],o=n.start?"^":"";const i=[];for(const e of t){const t=e.length?[]:[90];for(let r=0;r<e.length;r++){const a=e[r];let c=40+(n.sensitive?.25:0);if(0===a.type)r||(o+="/"),o+=a.value,c+=40;else if(1===a.type){const{value:t,repeatable:e,optional:n,regexp:s}=a;i.push({name:t,repeatable:e,optional:n});const u=s||C;if(u!==C){c+=10;try{new RegExp(`(${u})`)}catch(e){throw new Error(`Invalid custom RegExp for param "${t}" (${u}): `+e.message)}}let l=e?`((?:${u})(?:/(?:${u}))*)`:`(${u})`;r||(l=n?`(?:/${l})`:"/"+l),n&&(l+="?"),o+=l,c+=20,n&&(c+=-8),e&&(c+=-20),".*"===u&&(c+=-50)}t.push(c)}r.push(t)}if(n.strict){const t=r.length-1;r[t][r[t].length-1]+=.7000000000000001}n.strict||(o+="/?"),n.end&&(o+="$");const a=new RegExp(o,n.sensitive?"":"i");return{re:a,score:r,keys:i,parse:function(t){const e=t.match(a),n={};if(!e)return null;for(let t=1;t<e.length;t++){const r=e[t]||"",o=i[t-1];n[o.name]=r&&o.repeatable?r.split("/"):r}return n},stringify:function(e){let n="",r=!1;for(const o of t){r&&"/"===n[n.length-1]||(n+="/"),r=!1;for(const t of o)if(0===t.type)n+=t.value;else if(1===t.type){const{value:o,repeatable:i,optional:a}=t,c=o in e?e[o]:"";if(Array.isArray(c)&&!i)throw new Error(`Provided param "${o}" is an array but it is not repeatable (* or + modifiers)`);const s=Array.isArray(c)?c.join("/"):c;if(!s){if(!a)throw new Error(`Missing required param "${o}"`);r=!0}n+=s}}return n}}}(function(t){if(!t)return[[]];if("/"===t)return[[z]];if("/"!==t[0])throw new Error('A non-empty path must start with "/"');function e(t){throw new Error(`ERR (${n})/"${u}": ${t}`)}let n=0,r=n;const o=[];let i;function a(){i&&o.push(i),i=[]}let c,s=0,u="",l="";function f(){u&&(0===n?i.push({type:0,value:u}):1===n||2===n||3===n?(i.length>1&&("*"===c||"+"===c)&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:u,regexp:l,repeatable:"*"===c||"+"===c,optional:"*"===c||"?"===c})):e("Invalid state to consume buffer"),u="")}function h(){u+=c}for(;s<t.length;)if(c=t[s++],"\\"!==c||2===n)switch(n){case 0:"/"===c?(u&&f(),a()):":"===c?(f(),n=1):h();break;case 4:h(),n=r;break;case 1:"("===c?(n=2,l=""):K.test(c)?h():(f(),n=0,"*"!==c&&"?"!==c&&"+"!==c&&s--);break;case 2:")"===c?"\\"==l[l.length-1]?l=l.slice(0,-1)+c:n=3:l+=c;break;case 3:f(),n=0,"*"!==c&&"?"!==c&&"+"!==c&&s--;break;default:e("Unkwnonw state")}else r=n,n=4;return 2===n&&e(`Unfinished custom RegExp for param "${u}"`),f(),a(),o}(t.path),n),record:t,parent:e}}const V=/(.)\/+$/;function B(t,e){const n=[];function r(t,n){const i=function(t){return"redirect"in t?{path:t.path,redirect:t.redirect,name:t.name,beforeEnter:t.beforeEnter,meta:t.meta}:{path:t.path,components:"components"in t?t.components:{default:t.component},children:t.children,name:t.name,beforeEnter:t.beforeEnter,meta:t.meta}}(t),a={...e,...t.options};a.strict||(i.path=i.path.replace(V,"$1"));const c=[i];if("alias"in t&&t.alias){const e="string"==typeof t.alias?[t.alias]:t.alias;for(const t of e)c.push({...i,path:t})}if(n&&"/"!==t.path[0]){let e=n.record.path;for(const n of c)n.path&&(e+="/"),e+=t.path,n.path=e}for(const e of c){const i=M(e,n,a);if("children"in t&&t.children)for(const e of t.children)r(e,i);o(i)}}function o(t){let e=0;for(;e<n.length&&T(t,n[e])>=0;)e++;n.splice(e,0,t)}for(const e of t)r(e);return{addRoute:r,resolve:function(t,e){let r,o,i,a={};if("name"in t&&t.name){if(r=n.find(e=>e.record.name===t.name),!r)throw new P(t);if(i=r.record.name,a=t.params||e.params,o=r.stringify(a),"redirect"in r.record){const{redirect:t}=r.record;return{redirect:t,normalizedLocation:{name:i,path:o,matched:[],params:a,meta:r.record.meta||{}}}}}else if("path"in t){if(r=n.find(e=>e.re.test(t.path)),!r)throw new P(t);if(a=r.parse(t.path),o=t.path,i=r.record.name,"redirect"in r.record){const{redirect:t}=r.record;return{redirect:t,normalizedLocation:{name:i,path:o,matched:[],params:a,meta:r.record.meta||{}}}}}else{if(r=e.name?n.find(t=>t.record.name===e.name):n.find(t=>t.re.test(e.path)),!r)throw new P(t,e);i=r.record.name,a=t.params||e.params,o=r.stringify(a)}if("redirect"in r.record)throw new O(t);const c=[r.record];let s=r.parent;for(;s;){if("redirect"in s.record)throw new Error("TODO");c.unshift(s.record),s=s.parent}return{name:i,path:o,params:a,matched:c,meta:r.record.meta||{}}}}}function D(t,e,n){return()=>new Promise((r,o)=>{t(e,n,t=>{!1===t?o(new A(e,n)):!function(t){return"string"==typeof t||t&&"object"==typeof t}(t)?r():o(new _(e,t))})})}async function F(t,e,n,r){const o=[];return await Promise.all(t.map(async t=>{for(const i in t.components){const a=t.components[i],c=(await("function"==typeof a?a():a))[e];c&&o.push(D(c,n,r))}})),o}function J({history:e,routes:n,scrollBehavior:o}){const i=B(n),a=[],c=[];let f,h=t,p=t,m=[],y=[],g=!1;function w(t,e,n){e=e||h;const r=i.resolve(t,e);if("redirect"in r){const{redirect:o}=r,i={...r.normalizedLocation,fullPath:s({path:r.normalizedLocation.path,query:t.query,hash:t.hash}),query:u(t.query||{}),hash:t.hash,redirectedFrom:n,meta:{}};if("string"==typeof o)return w(l(o),e,i);if("function"==typeof o){const t=o(i);return w("string"==typeof t?l(t):{...t,query:u(t.query||{}),hash:t.hash||""},e,i)}return w({...o,query:u(o.query||{}),hash:o.hash||""},e,i)}{const e=l({path:r.path,query:t.query,hash:t.hash});return{...r,...e,redirectedFrom:n}}}async function v(n){let r,o;if("string"==typeof n||"path"in n&&!("name"in n))r=l(n),o=w(r,h);else{const t=n.query?u(n.query):{},e=n.hash||"";o=w({...n,query:t,hash:e},h),r=l({query:t,hash:e,...o})}if(h!==t&&h.fullPath===r.fullPath)return h;const i=o;p=i;try{await $(i,h)}catch(t){if(_.is(t)){if(p!==i)throw new L(i,h);return v(t.to)}if(p!==i)throw new L(i,h);E(t)}if(p!==i)throw new L(i,h);!0===n.replace?e.replace(r):e.push(r);const a=h;h=i,x(),R(i,a).catch(t=>E(t,!1));for(const t of c)t(i,a);return h}async function b(t){for(const e of t)await e()}async function $(t,e){let n;n=await F(e.matched.filter(e=>t.matched.indexOf(e)<0).reverse(),"beforeRouteLeave",t,e),await b(n),n=[];for(const r of a)n.push(D(r,t,e));await b(n),n=await F(t.matched.filter(t=>e.matched.indexOf(t)>-1),"beforeRouteUpdate",t,e),await b(n),n=[];for(const r of t.matched)if(r.beforeEnter&&e.matched.indexOf(r)<0)if(Array.isArray(r.beforeEnter))for(const o of r.beforeEnter)n.push(D(o,t,e));else n.push(D(r.beforeEnter,t,e));await b(n),n=await F(t.matched.filter(t=>e.matched.indexOf(t)<0),"beforeRouteEnter",t,e),await b(n)}function E(t,e=!0){for(const e of y)e(t);if(e)throw t}function x(){if(!f)return;const t={...h};Object.defineProperty(t,"matched",{enumerable:!1}),f._route=Object.freeze(t),P()}function P(e){if(!g&&h!==t){g=!0;for(const[t]of m)t(e);m=[]}}async function R(t,e,n){if(!o)return;await f.$nextTick();const r=await o(t,e,n||null);console.log("scrolling to",r),d(r)}e.listen(async(t,n,r)=>{const o=w(t,h),i={...t,...o};p=i;try{if(await $(i,h),p!==i)return E(new L(i,h),!1);h={...t,...o},x();const{state:e}=window.history;R(i,h,e.scroll).catch(t=>E(t,!1))}catch(t){if(_.is(t)){if(p!==i)return E(new L(i,h),!1);E(t,!1),v(t.to).catch(()=>{})}else A.is(t)?(console.log("Cancelled, going to",-r.distance),e.go(-r.distance,!1)):E(t,!1)}});const O={currentRoute:h,push:v,replace:function(t){return v({..."string"==typeof t?{path:t}:t,replace:!0})},resolve:function(t,e){return w("string"==typeof t?l(t):{query:{},hash:"",...t},e)},beforeEach:function(t){return a.push(t),()=>{const e=a.indexOf(t);e>-1&&a.splice(e,1)}},afterEach:function(t){return c.push(t),()=>{const e=c.indexOf(t);e>-1&&c.splice(e,1)}},createHref:function(t){return e.base+t.fullPath},onError:function(t){y.push(t)},onReady:function(){return g&&h!==t?Promise.resolve():new Promise((t,e)=>{m.push([t,e])})},doInitialNavigation:async function(){if(e.location===r)return;const t=w(e.location,h);p=t;try{await $(t,h)}catch(e){if(P(e),_.is(e)){if(p!==t)throw new L(t,h);return void await v(e.to)}if(p!==t)throw new L(t,h);E(e)}if(p!==t){const e=new L(t,h);throw P(e),e}const n=h;h=t,x();for(const e of c)e(t,n);P()},setActiveApp:function(t){f=t,x()}};return Object.defineProperty(O,"currentRoute",{get:()=>h}),O}const H=console;function G(t,e){const{pathname:n,search:r,hash:i}=e;if(t.indexOf("#")>-1)return o(f("/"+i,t));const a=f(n,t);return{fullPath:a+r+i,path:a,query:c(r),hash:i}}function X(t=""){const r=function(t){const{history:e}=window;function n(t,e,n,r=!1,o=!1){return{back:t,current:e,forward:n,replaced:r,position:window.history.length,scroll:o?h():null}}let r={value:G(t,window.location)},o={value:e.state};function i(n,r,i,a){const c=t+i;try{const t=a?{...o.value,...n}:n;e[a?"replaceState":"pushState"](t,r,c),o.value=n}catch(t){H.log("[vue-router]: Error with push/replace State",t),window.location[a?"replace":"assign"](c)}}return o.value||i({back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:h()},"",r.value.fullPath,!0),{location:r,state:o,push:function(t,e){const a=l(t),c={...o.value,forward:a,scroll:h()};i(c,"",c.current.fullPath,!0),i({...n(r.value,a,null),position:c.position+1,...e},"",a.fullPath,!1),r.value=a},replace:function(t){const e=l(t),a=n(o.value.back,e,o.value.forward,!0);o&&(a.position=o.value.position),i(a,"",e.fullPath,!0),r.value=e}}}(t),o=function(t,r,o){let i=[],a=[],c=null;const s=({state:a})=>{H.info("popstate fired",a),H.info("currentState",r);const s=o.value,u=r.value,l=G(t,window.location);if(o.value=l,r.value=a,c&&c.fullPath===s.fullPath)return H.info("❌ Ignored beacuse paused for",c.fullPath),void(c=null);const f=u?a.position-u.position:"";console.log({deltaFromCurrent:f}),i.forEach(t=>t(o.value,s,{distance:f||0,type:e.pop,direction:f?f>0?n.forward:n.back:n.unknown}))};return window.addEventListener("popstate",s),{pauseListeners:function(){H.info(`⏸ for ${o.value.fullPath}`),c=o.value},listen:function(t){i.push(t);const e=()=>{const e=i.indexOf(t);e>-1&&i.splice(e,1)};return a.push(e),e},destroy:function(){for(const t of a)t();a=[],window.removeEventListener("popstate",s)}}}(t,r.state,r.location);function i(t,e=!0){e||o.pauseListeners(),history.go(t)}const a={location:r.location.value,base:t,back:function(t=!0){i(-1,t)},forward:function(t=!0){i(1,t)},go:i,...r,...o};return Object.defineProperty(a,"location",{get:()=>r.location.value}),a}function Y(t=""){let o=[],i=[r],a=0;function c(t){a++,a===i.length?i.push(t):(i.splice(a),i.push(t))}const s={location:r,base:t,replace(t){const e=l(t);i.splice(a--,1),c(e)},push(t,e){c(l(t))},listen:t=>(o.push(t),()=>{const e=o.indexOf(t);e>-1&&o.splice(e,1)}),destroy(){o=[]},back(t=!0){this.go(-1,t)},forward(t=!0){this.go(1,t)},go(t,r=!0){const c=this.location,s=t<0?n.back:n.forward;a=Math.max(0,Math.min(a+t,i.length-1)),r&&function(t,n,{direction:r,distance:i}){const a={direction:r,distance:i,type:e.pop};for(let e of o)e(t,n,a)}(this.location,c,{direction:s,distance:t})}};return Object.defineProperty(s,"location",{get:()=>i[a]}),s}function Z(t=""){return X("/#"+t)}const Q={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render(t,{children:e,parent:n,data:r,props:o}){r.routerView=!0;const i=n.$createElement,a=n.$route;let c=0;for(;n&&n._routerRoot!==n;){const t=n.$vnode&&n.$vnode.data;t&&t.routerView&&c++,n=n.$parent}r.routerViewDepth=c;const s=a.matched[c];return s?i(s.components[o.name],r,e):i()}},W={name:"RouterLink",props:{to:{type:[String,Object],required:!0}},render(t){const e=this.$router,n=(this.$route,this.to),r=e.resolve(n);return t("a",{on:{click:t=>{(function(t){if(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)return;if(t.defaultPrevented)return;if(void 0!==t.button&&0!==t.button)return;if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}t.preventDefault&&t.preventDefault();return!0})(t)&&e.push(r)}},attrs:{href:e.createHref(r)}},this.$slots.default)}};const tt=t=>{t.mixin({beforeCreate(){if("router"in this.$options){this._routerRoot=this;const e=this.$options.router;this._router=e,e.setActiveApp(this),t.util.defineReactive(this,"_route",e.currentRoute),e.doInitialNavigation().catch(t=>{console.error("Unhandled error",t)})}else this._routerRoot=this.$parent&&this.$parent._routerRoot||this}}),Object.defineProperty(t.prototype,"$router",{get(){return this._routerRoot._router}}),Object.defineProperty(t.prototype,"$route",{get(){return this._routerRoot._route}}),t.component("RouterView",Q),t.component("RouterLink",W);const e=t.config.optionMergeStrategies;e.beforeRouteEnter=e.beforeRouteLeave=e.beforeRouteUpdate=e.created};export{Z as createHashHistory,X as createHistory,Y as createMemoryHistory,J as createRouter,tt as plugin};
